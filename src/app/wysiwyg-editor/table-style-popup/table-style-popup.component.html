<div class="popup-overlay">
  <div class="popup-container">
    <h2 *ngIf="styleType === 'table'">Table Styles</h2>
    <h2 *ngIf="styleType === 'row'">Row Styles</h2>
    <h2 *ngIf="styleType === 'cell'">Cell Styles</h2>

    <div *ngIf="styleType === 'table'" class="style-section">
      <div class="style-control">
        <label>Border Color:</label>
        <button type="button" class="paint-icon-btn" (click)="openTableBorderColorPicker()" [style.background]="borderColor" title="Pick border color">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
            <path d="M12 3C7.03 3 3 7.03 3 12c0 3.87 3.13 7 7 7h1a2 2 0 0 0 2-2c0-.55.45-1 1-1h2a3 3 0 0 0 3-3c0-4.97-4.03-9-9-9z" fill="#f4e1b1"/>
            <circle cx="8.5" cy="10.5" r="1.5" fill="#f44336"/>
            <circle cx="15.5" cy="10.5" r="1.5" fill="#2196f3"/>
            <circle cx="12" cy="7.5" r="1.5" fill="#4caf50"/>
            <circle cx="12" cy="15.5" r="1.5" fill="#ffeb3b"/>
          </svg>
        </button>
        <div *ngIf="showTableBorderColorPicker" class="color-picker-popup-inline">
          <app-color-picker (colorSelected)="onTableBorderColorSelected($event)"></app-color-picker>
        </div>
      </div>
      <div class="style-control">
        <label>Width:</label>
        <input type="text" [(ngModel)]="tableWidth" (ngModelChange)="onTableWidthChange($event)" class="input-width-medium" placeholder="e.g. 100%, 400px" />
        <span style="margin-left:8px;">
          <button type="button" (click)="setTableWidthPreset('100%')">100%</button>
          <button type="button" (click)="setTableWidthPreset('80%')">80%</button>
          <button type="button" (click)="setTableWidthPreset('50%')">60%</button>
          <button type="button" (click)="setTableWidthPreset('80%')">80%</button>
        </span>
      </div>
      <div class="style-control">
        <label>Alignment:</label>
        <span style="display:inline-flex;gap:4px;">
          <button type="button" [class.selected]="tableAlign==='left'" (click)="setTableAlign('left')" title="Align Left">⬅️</button>
          <button type="button" [class.selected]="tableAlign==='center'" (click)="setTableAlign('center')" title="Align Center">↔️</button>
          <button type="button" [class.selected]="tableAlign==='right'" (click)="setTableAlign('right')" title="Align Right">➡️</button>
        </span>
      </div>
      <div class="style-control">
        <label>Style:</label>
        <select [(ngModel)]="borderStyle" (ngModelChange)="onBorderStyleChange($event)">
          <option value="solid">Solid</option>
          <option value="dashed">Dashed</option>
          <option value="dotted">Dotted</option>
          <option value="double">Double</option>
          <option value="groove">Groove</option>
          <option value="ridge">Ridge</option>
          <option value="inset">Inset</option>
          <option value="outset">Outset</option>
          <option value="none">None</option>
        </select>
      </div>
    </div>

    <div *ngIf="styleType === 'row'" class="style-section">
      <div class="style-control">
        <label>Top Border Color:</label>
        <button type="button" class="paint-icon-btn" (click)="openRowTopBorderColorPicker()" [style.background]="topBorderColor" title="Pick top border color">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
            <path d="M12 3C7.03 3 3 7.03 3 12c0 3.87 3.13 7 7 7h1a2 2 0 0 0 2-2c0-.55.45-1 1-1h2a3 3 0 0 0 3-3c0-4.97-4.03-9-9-9z" fill="#f4e1b1"/>
            <circle cx="8.5" cy="10.5" r="1.5" fill="#f44336"/>
            <circle cx="15.5" cy="10.5" r="1.5" fill="#2196f3"/>
            <circle cx="12" cy="7.5" r="1.5" fill="#4caf50"/>
            <circle cx="12" cy="15.5" r="1.5" fill="#ffeb3b"/>
          </svg>
        </button>
        <div *ngIf="showRowTopBorderColorPicker" class="color-picker-popup-inline">
          <app-color-picker (colorSelected)="onRowTopBorderColorSelected($event)"></app-color-picker>
        </div>
      </div>
      <div class="style-control">
        <label>Top Border Width:</label>
        <input type="number" min="0" max="10" [(ngModel)]="topBorderWidth" class="input-width-small" /> px
      </div>
      <div class="style-control">
        <label>Top Border Style:</label>
        <select [(ngModel)]="topBorderStyle">
          <option value="solid">Solid</option>
          <option value="dashed">Dashed</option>
          <option value="dotted">Dotted</option>
          <option value="double">Double</option>
          <option value="groove">Groove</option>
          <option value="ridge">Ridge</option>
          <option value="inset">Inset</option>
          <option value="outset">Outset</option>
          <option value="none">None</option>
        </select>
      </div>
      <div class="style-control">
        <label>Bottom Border Color:</label>
        <button type="button" class="paint-icon-btn" (click)="openRowBottomBorderColorPicker()" [style.background]="bottomBorderColor" title="Pick bottom border color">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
            <path d="M12 3C7.03 3 3 7.03 3 12c0 3.87 3.13 7 7 7h1a2 2 0 0 0 2-2c0-.55.45-1 1-1h2a3 3 0 0 0 3-3c0-4.97-4.03-9-9-9z" fill="#f4e1b1"/>
            <circle cx="8.5" cy="10.5" r="1.5" fill="#f44336"/>
            <circle cx="15.5" cy="10.5" r="1.5" fill="#2196f3"/>
            <circle cx="12" cy="7.5" r="1.5" fill="#4caf50"/>
            <circle cx="12" cy="15.5" r="1.5" fill="#ffeb3b"/>
          </svg>
        </button>
        <div *ngIf="showRowBottomBorderColorPicker" class="color-picker-popup-inline">
          <app-color-picker (colorSelected)="onRowBottomBorderColorSelected($event)"></app-color-picker>
        </div>
      </div>
      <div class="style-control">
        <label>Bottom Border Width:</label>
        <input type="number" min="0" max="10" [(ngModel)]="bottomBorderWidth" class="input-width-small" /> px
      </div>
      <div class="style-control">
        <label>Bottom Border Style:</label>
        <select [(ngModel)]="bottomBorderStyle">
          <option value="solid">Solid</option>
          <option value="dashed">Dashed</option>
          <option value="dotted">Dotted</option>
          <option value="double">Double</option>
          <option value="groove">Groove</option>
          <option value="ridge">Ridge</option>
          <option value="inset">Inset</option>
          <option value="outset">Outset</option>
          <option value="none">None</option>
        </select>
      </div>
    </div>

    <div *ngIf="styleType === 'cell'" class="style-section">
      <div class="style-control">
        <label>Background Color:</label>
        <button type="button" class="paint-icon-btn" (click)="openCellBgColorPicker()" [style.background]="cellBgColor" title="Pick cell background color">
          <svg width="26" height="26" viewBox="0 0 24 24" fill="none">
            <path d="M12 3C7.03 3 3 7.03 3 12c0 3.87 3.13 7 7 7h1a2 2 0 0 0 2-2c0-.55.45-1 1-1h2a3 3 0 0 0 3-3c0-4.97-4.03-9-9-9z" fill="#f4e1b1"/>
            <circle cx="8.5" cy="10.5" r="1.5" fill="#f44336"/>
            <circle cx="15.5" cy="10.5" r="1.5" fill="#2196f3"/>
            <circle cx="12" cy="7.5" r="1.5" fill="#4caf50"/>
            <circle cx="12" cy="15.5" r="1.5" fill="#ffeb3b"/>
          </svg>
        </button>
        <div *ngIf="showCellBgColorPicker" class="color-picker-popup-inline">
          <app-color-picker (colorSelected)="onCellBgColorSelected($event)"></app-color-picker>
        </div>
      </div>
      <div class="style-control">
        <label>Horizontal Align:</label>
        <select [(ngModel)]="cellAlign" (ngModelChange)="onCellAlignChange($event)">
          <option value="left">Left</option>
          <option value="center">Center</option>
          <option value="right">Right</option>
          <option value="justify">Justify</option>
        </select>
      </div>
      <div class="style-control">
        <label>Vertical Align:</label>
        <select [(ngModel)]="cellVAlign" (ngModelChange)="onCellVAlignChange($event)">
          <option value="top">Top</option>
          <option value="middle">Middle</option>
          <option value="bottom">Bottom</option>
        </select>
      </div>
    </div>

    <div class="popup-actions">
      <button (click)="apply()">Apply</button>
      <button (click)="closePopup()">Close</button>
    </div>
  </div>
</div>
